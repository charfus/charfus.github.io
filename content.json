{"meta":{"title":"HaneulDev","subtitle":"hi hallo","description":"개발에 관련된 포스팅이 주를 이를 것으로 예상","author":"Haneul Cha","url":"https://haneulcha.github.io","root":"/"},"pages":[{"title":"about","date":"2020-09-12T15:37:24.000Z","updated":"2020-09-15T02:22:13.725Z","comments":true,"path":"about/index.html","permalink":"https://haneulcha.github.io/about/index.html","excerpt":"","text":"안녕하세요, 저는 차하늘입니다. 고양이 한 마리가 있습니다.Hi, i’m haneul. I have a cat."}],"posts":[{"title":"CSP(Content Security Policy)","slug":"CSP-Content-Security-Policy","date":"2020-12-26T11:00:19.000Z","updated":"2020-12-26T11:38:55.552Z","comments":true,"path":"2020/12/26/CSP-Content-Security-Policy/","link":"","permalink":"https://haneulcha.github.io/2020/12/26/CSP-Content-Security-Policy/","excerpt":"","text":"결론서버에서 helmet 메소드로 설정할 수 있었다.","categories":[{"name":"Post","slug":"Post","permalink":"https://haneulcha.github.io/categories/Post/"}],"tags":[{"name":"project","slug":"project","permalink":"https://haneulcha.github.io/tags/project/"},{"name":"galpi","slug":"galpi","permalink":"https://haneulcha.github.io/tags/galpi/"},{"name":"deploy","slug":"deploy","permalink":"https://haneulcha.github.io/tags/deploy/"}]},{"title":"Global Object Id","slug":"Global-Object-Id","date":"2020-10-19T13:43:20.000Z","updated":"2020-12-26T10:38:00.000Z","comments":true,"path":"2020/10/19/Global-Object-Id/","link":"","permalink":"https://haneulcha.github.io/2020/10/19/Global-Object-Id/","excerpt":"","text":"20년 10월 19일 22시 43분 현재 내가 처한 상황:사람들이 올릴 각 포스트를 볼 수 있는 url이 필요하다. 무엇을 포스트의 고유한 식별자로 하지. mongoDB의 _id를 그대로 노출 시키기는 뭔가 찜찜하다. 유저 프로필의 경우엔 그냥 username으로 했는데… 인스타에 들어가서 포스트를 클릭해보니 보니 그리 길지 않은 고유 아이디를 url로 쓰고 있다. 어찌저찌 검색을 해보니 키워드는 ‘global object id’ 정도인 것 같고, ‘auto increment’에 대한 포스팅과 스택오버플로우의 질문들도 발견했다. ‘인덱스’와 ‘샤딩’은 아직 어디에 어떻게 쓰이는지 잘 모르겠다.그리고 ‘shortid’라는 npm 패키지도 발견했다. 해결하자… 12월 26일 배포까지 끝난 시점:이 고민은 사실 별 건 아니였다. nanoid, shortid, uuid 등 그냥 목적에 맞는 uuid 패키지를 검색해서 schema에서 uuid 생성 함수를 적용하니 해결되었다. mongoDB에서 원래 자동 생성되는 _id를 대신해서 uuid를 쓰는 것도 가능한데 나는 uuid 프로퍼티를 따로 추가했다. 처음에 왜 _id를 노출시키는 게 찜찜했는지는 나도 잘 모르겠다. 이후에 정렬을 해야할 일이 생길지도 모르겠다는 생각이 들어서 uuid와 별개로 index를 추가해서, 유저가 포스팅 할 때마다 increment 되도록 mongoDB 쿼리를 뒤져서 함수를 작성했다. 12345const index &#x3D; await Sequence.findOneAndUpdate( &#123; user &#125;, &#123; $inc: &#123; uid: 1 &#125; &#125;, &#123; new: true &#125; ); 개발 중간에 알아차린 실수는 uuid 생성 함수를 딸랑 쓰면 안 되고, 콜백으로 처리해야 한다는 점이였다. 처음에 딸랑 nanoid() 이렇게만 썼다가 모든 포스트의 uuid가 동일해졌고, 정반대의 목적으로 uuid를 활용한 꼴이 되었다. 12345678const postSchema &#x3D; new Schema(&#123; ... uuid: &#123; type: String, default: () &#x3D;&gt; nanoid(), &#125;, ...&#125; 결과적으로 모든 포스트가 /p/:uuid 주소로 각각 url을 갖게 되었다.","categories":[{"name":"Post","slug":"Post","permalink":"https://haneulcha.github.io/categories/Post/"}],"tags":[{"name":"mongoDB","slug":"mongoDB","permalink":"https://haneulcha.github.io/tags/mongoDB/"},{"name":"project","slug":"project","permalink":"https://haneulcha.github.io/tags/project/"},{"name":"galpi","slug":"galpi","permalink":"https://haneulcha.github.io/tags/galpi/"}]},{"title":"블로그를 만들었다","slug":"블로그를-만들었다","date":"2020-09-13T01:59:00.000Z","updated":"2020-09-15T02:23:56.711Z","comments":true,"path":"2020/09/13/블로그를-만들었다/","link":"","permalink":"https://haneulcha.github.io/2020/09/13/%EB%B8%94%EB%A1%9C%EA%B7%B8%EB%A5%BC-%EB%A7%8C%EB%93%A4%EC%97%88%EB%8B%A4/","excerpt":"","text":"인터넷을 접한지 20년이 다 되어가고, 그 동안 스쳐지나간 개인 홈페이지, 미니홈피, 블로그가 수십 개다…그 중 하나만 진득하게 했더라면… (사실 크게 달라진 것 없었겠지만…)다 큰 성인이 되고나서도 한참 후에야 이렇게 또 블로그를 하나 만들었다.이번에는 또 얼마나 가려나.. 라는 생각은 하지 않고 그냥 이것저것 기록을 해보겠다.대신 좀 더 책임감 있는 포스팅이 되길 바라고 스스로 다짐…👴","categories":[{"name":"Post","slug":"Post","permalink":"https://haneulcha.github.io/categories/Post/"}],"tags":[]}],"categories":[{"name":"Post","slug":"Post","permalink":"https://haneulcha.github.io/categories/Post/"}],"tags":[{"name":"project","slug":"project","permalink":"https://haneulcha.github.io/tags/project/"},{"name":"galpi","slug":"galpi","permalink":"https://haneulcha.github.io/tags/galpi/"},{"name":"deploy","slug":"deploy","permalink":"https://haneulcha.github.io/tags/deploy/"},{"name":"mongoDB","slug":"mongoDB","permalink":"https://haneulcha.github.io/tags/mongoDB/"}]}